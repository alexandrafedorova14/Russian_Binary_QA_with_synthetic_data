# Правиловая генерация общих вопросов в русском языке

Для генерации общих вопросов на основе правил сначала отбираются предложения заданной синтаксической структуры: 
1. Предложения с переходными глаголами (например "Школьные занятия разочаровали Стива своим формализмом."); 
2. Предложения с непереходными глаголами (например "В Польшу он вернулся перед самой войной, приведшей ко второму разделу государства.")

Предложения отбирались из дампа Википедии за март-апрель 2023 года. Всего было отобрано 4726 предложений обоих типов, затем на одной части генерировались общие вопросы с ответом "да", а на другой – с ответом "нет". При дообучении на классификацию в обучающую выборку попадет меньше предложений, поскольку требовалось избавиться от сильного дисбаланса классов. 

<ins>Весь алгоритм можно разделить на три части:</ins>
1. отбор подходящих предложений по синтаксическому шаблону; 
1. вопросительные преобразования (в том числе создание вопросительных, отрицательных частиц, поиск необходимых узлов в дереве зависимостей входного предложения, изменение структуры предложения);
2. запись полученных вопросительных предложений в обычном текстовом виде

Сначала отобранные предложения подаются на вход модели для морфо-синтаксической разметки для русского языка из библиотеки stanza. Модель была обучена на на корпусе Russian SynTagRus, собранном в рамках проекта Universal Dependences. Выходные данные модель записываются в формате CONNL-U и представляют собой полный синтаксический и морфологический анализ исходного текста (исходных предложений). Все размеченные файлы сохраняются с расширением .conll, так что в дальнейшем на вход функции для генерации опредленного типа предложения подается предложение уже после парсинга и с ним происходят синтаксические преобразования. Все вопросительные преобразования (добавление частицы <i>ли</i>, выдвижение определенной части предложения в фокус, добавление отрицательной частицы <i>не</i> и тд.) осуществляются с помощью фреймворка Udapi (Popel et al., 2017), который позволяет работать с данными проекта Universal Dependences.  

Всего алгоритм позволяет сгенерировать 72 типа общие вопросы в русском языке (36 для предложений с переходными глаголами и 36 для предложений с непереходными). Такое большое количество из-за того, что в русском языке свободный порядок слов. Каждому типу соответствует отдельная функция, которая получает на вход предложение в формате CONNL-U, которое она преобразует в дерево зависимостей. Далее вызывается одна из четырех функций, которые добавляют частицу <i>ли</i>, частицу <i>не...ли</i>, частицу <i>не</i> или фразу <i>Правда ли</i>, после этого алгоритм производит определенные манипуляции над порядком слов. После из дерева зависимостей удаляются узлы, которые никоим образом не влияют на семантику будущего вопроса. Остаются только те узлы, которые являются прилагательными, модификаторами, предлогами, предписывающими падеж ИГ, а также числительные. При изменении порядка слов и удалении части узлов из дерева, важную роль снова играет учет всех возможных зависимых узла с левой и с правой сторон. Это делает для того, чтобы избежать случаев, когда мы поменяли порядок слов и случайно разделили ИГ с ее зависимыми (например, такая ситуация может пройти при перестановке объекта перед субъектом).

Поскольку в генерируемых вопросах остается та же лексика, что и в исходном утвердительном предложении, то было принято решение использовать рерайтер/парафрайзер, который позволит немного изменить вопросы и возможно добавить синонимизацию. Рерайт осуществлялся с помощью рерайтера Сбера, который находится в открытом доступе. К рерайтеру можно обращаться через POST-запросы. <ins>Параметры генерации были выбраны следующие:</ins> 
* temperature = 1.0
* top-k = 50
* top-p = 0.7

Наилучший вариант перефразированного вопроса выбирался с помощью ранжировщика bertscore. 
